<!DOCTYPE html>
<html ng-app="cleanUI">
<head lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>AdValoram Clothing</title>

    <link href="assets/common/img/favicon.144x144.png" rel="apple-touch-icon" type="image/png" sizes="144x144">
    <link href="assets/common/img/favicon.114x114.png" rel="apple-touch-icon" type="image/png" sizes="114x114">
    <link href="assets/common/img/favicon.72x72.png" rel="apple-touch-icon" type="image/png" sizes="72x72">
    <link href="assets/common/img/favicon.57x57.png" rel="apple-touch-icon" type="image/png">
    <link href="assets/common/img/favicon.png" rel="icon" type="image/png">
    <link href="../favicon.ico" rel="shortcut icon">

    <!-- HTML5 shim and Respond.js for < IE9 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Vendors Styles -->
    <!-- v1.0.0 -->
    <link rel="stylesheet" type="text/css" href="assets/vendors/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="assets/vendors/jscrollpane/style/jquery.jscrollpane.css">
    <link rel="stylesheet" type="text/css" href="assets/vendors/ladda/dist/ladda-themeless.min.css">
    <link rel="stylesheet" type="text/css" href="assets/vendors/select2/dist/css/select2.min.css">
    <link rel="stylesheet" type="text/css" href="assets/vendors/eonasdan-bootstrap-datetimepicker/build/css/bootstrap-datetimepicker.min.css">
    <link rel="stylesheet" type="text/css" href="assets/vendors/fullcalendar/dist/fullcalendar.min.css">
    <link rel="stylesheet" type="text/css" href="assets/vendors/cleanhtmlaudioplayer/src/player.css">
    <link rel="stylesheet" type="text/css" href="assets/vendors/cleanhtmlvideoplayer/src/player.css">
    <link rel="stylesheet" type="text/css" href="assets/vendors/bootstrap-sweetalert/dist/sweetalert.css">
    <link rel="stylesheet" type="text/css" href="assets/vendors/summernote/dist/summernote.css">
    <link rel="stylesheet" type="text/css" href="assets/vendors/owl.carousel/dist/assets/owl.carousel.min.css">
    <link rel="stylesheet" type="text/css" href="assets/vendors/ionrangeslider/css/ion.rangeSlider.css">
    <link rel="stylesheet" type="text/css" href="assets/vendors/datatables/media/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" type="text/css" href="assets/vendors/c3/c3.min.css">
    <link rel="stylesheet" type="text/css" href="assets/vendors/chartist/dist/chartist.min.css">
    <!-- v1.4.0 -->
    <link rel="stylesheet" type="text/css" href="assets/vendors/nprogress/nprogress.css">
    <link rel="stylesheet" type="text/css" href="assets/vendors/jquery-steps/demo/css/jquery.steps.css">
    <!-- v1.4.2 -->
    <link rel="stylesheet" type="text/css" href="assets/vendors/bootstrap-select/dist/css/bootstrap-select.min.css">
    <!-- v1.7.0 -->
    <link rel="stylesheet" type="text/css" href="assets/vendors/dropify/dist/css/dropify.min.css">

    <!-- Clean UI Styles -->
    <link rel="stylesheet" type="text/css" href="assets/common/css/source/main.css">

    <!-- Vendors Scripts -->
    <!-- v1.0.0 -->
    <script src="assets/vendors/jquery/jquery.min.js"></script>
    <script src="assets/vendors/tether/dist/js/tether.min.js"></script>
    <script src="assets/vendors/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="assets/vendors/jquery-mousewheel/jquery.mousewheel.min.js"></script>
    <script src="assets/vendors/jscrollpane/script/jquery.jscrollpane.min.js"></script>
    <script src="assets/vendors/spin.js/spin.js"></script>
    <script src="assets/vendors/ladda/dist/ladda.min.js"></script>
    <script src="assets/vendors/select2/dist/js/select2.full.min.js"></script>
    <script src="assets/vendors/html5-form-validation/dist/jquery.validation.min.js"></script>
    <script src="assets/vendors/jquery-typeahead/dist/jquery.typeahead.min.js"></script>
    <script src="assets/vendors/jquery-mask-plugin/dist/jquery.mask.min.js"></script>
    <script src="assets/vendors/autosize/dist/autosize.min.js"></script>
    <script src="assets/vendors/bootstrap-show-password/bootstrap-show-password.min.js"></script>
    <script src="assets/vendors/moment/min/moment.min.js"></script>
    <script src="assets/vendors/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js"></script>
    <script src="assets/vendors/fullcalendar/dist/fullcalendar.min.js"></script>
    <script src="assets/vendors/cleanhtmlaudioplayer/src/jquery.cleanaudioplayer.js"></script>
    <script src="assets/vendors/cleanhtmlvideoplayer/src/jquery.cleanvideoplayer.js"></script>
    <script src="assets/vendors/bootstrap-sweetalert/dist/sweetalert.min.js"></script>
    <script src="assets/vendors/remarkable-bootstrap-notify/dist/bootstrap-notify.min.js"></script>
    <script src="assets/vendors/summernote/dist/summernote.min.js"></script>
    <script src="assets/vendors/owl.carousel/dist/owl.carousel.min.js"></script>
    <script src="assets/vendors/ionrangeslider/js/ion.rangeSlider.min.js"></script>
    <script src="assets/vendors/nestable/jquery.nestable.js"></script>
    <script src="assets/vendors/datatables/media/js/jquery.dataTables.min.js"></script>
    <script src="assets/vendors/datatables/media/js/dataTables.bootstrap4.min.js"></script>
    <script src="assets/vendors/datatables-fixedcolumns/js/dataTables.fixedColumns.js"></script>
    <script src="assets/vendors/datatables-responsive/js/dataTables.responsive.js"></script>
    <script src="assets/vendors/editable-table/mindmup-editabletable.js"></script>
    <script src="assets/vendors/d3/d3.min.js"></script>
    <script src="assets/vendors/c3/c3.min.js"></script>
    <script src="assets/vendors/chartist/dist/chartist.min.js"></script>
    <script src="assets/vendors/peity/jquery.peity.min.js"></script>
    <!-- v1.0.1 -->
    <script src="assets/vendors/chartist-plugin-tooltip/dist/chartist-plugin-tooltip.min.js"></script>
    <!-- v1.1.1 -->
    <script src="assets/vendors/gsap/src/minified/TweenMax.min.js"></script>
    <script src="assets/vendors/hackertyper/hackertyper.js"></script>
    <script src="assets/vendors/jquery-countTo/jquery.countTo.js"></script>
    <!-- v1.4.0 -->
    <script src="assets/vendors/nprogress/nprogress.js"></script>
    <script src="assets/vendors/jquery-steps/build/jquery.steps.min.js"></script>
    <!-- v1.4.2 -->
    <script src="assets/vendors/bootstrap-select/dist/js/bootstrap-select.min.js"></script>
    <script src="assets/vendors/chart.js/src/Chart.bundle.min.js"></script>
    <!-- v1.7.0 -->
    <script src="assets/vendors/dropify/dist/js/dropify.min.js"></script>


    <!-- Angular Version Scripts -->
    <script src="assets/vendors/angular/angular.min.js"></script>
    <script src="assets/vendors/angular-route/angular-route.min.js"></script>
    <script src="assets/common/js/version_angular/app.js"></script>

    <!-- Angular Version Controllers -->
<!--    <script src="pages/register.ctrl.js"></script>
    <script src="pages/login.ctrl.js"></script>
    <script src="pages/lockscreen.ctrl.js"></script>
-->

    <!-- Clean UI Scripts -->
    <script src="assets/common/js/common.js"></script>
    <script src="assets/common/js/demo.temp.js"></script>
	<script src="js/common.js"></script>
</head>

<body class="theme-blue menu-top menu-top-compact menu-static colorful-enabled" ng-controller="MainCtrl" onload="fetchLocations();fetchTransporters();">

<nav class="left-menu" left-menu ng-class="{'hidden-left-menu': hideLeftMenu}">
    <div class="logo-container">
        <a href="#/dashboards/alpha" class="logo">
            <img src="assets/common/img/logo.png" alt="AdValoram Clothing" />
            <img class="logo-inverse" src="assets/common/img/logo.png" alt="AdValoram Clothing" />
        </a>
    </div>
    <div class="left-menu-inner scroll-pane">
        <ul class="left-menu-list left-menu-list-root list-unstyled">   
		
            <li>
                <a class="left-menu-link" href="home.html">
                    <i class="left-menu-link-icon icmn-home2"></i>
                    Home
                </a>
            </li>

            <li class="left-menu-list-separator"><!-- --></li>
            <li class="left-menu-list-submenu">
                <a class="left-menu-link" href="javascript: void(0);">
                    <i class="left-menu-link-icon icmn-files-empty2"><!-- --></i>
                    Dashboard
                </a>
                <ul class="left-menu-list list-unstyled">
                    <li>
                        <a class="left-menu-link" href="#">
                            Purchase
                        </a>
                    </li>
                    <li>
                        <a class="left-menu-link" href="#">
                            Inventory
                        </a>
                    </li>
					<li>
                        <a class="left-menu-link" href="#">
                            Sales
                        </a>
                    </li>
                </ul>
            </li>
			<li class="left-menu-list-separator"><!-- --></li>
            <li>
                <a class="left-menu-link" href="#">
                    <i class="left-menu-link-icon icmn-profile"><!-- --></i>
                    Purchase
                </a>
            </li>
			<li class="left-menu-list-separator"><!-- --></li>
            <li>
                <a class="left-menu-link" href="#">
                    <i class="left-menu-link-icon icmn-profile"><!-- --></i>
                    Inventory
                </a>
            </li>
			<li class="left-menu-list-separator"><!-- --></li>
            <li class="left-menu-list-submenu">
                <a class="left-menu-link" href="javascript: void(0);">
                    <i class="left-menu-link-icon icmn-files-empty2"><!-- --></i>
                    Sales
                </a>
                <ul class="left-menu-list list-unstyled">
                    <li>
                        <a class="left-menu-link" href="landing-sales-order.html">
                            Sales Order
                        </a>
                    </li>
                    <li>
                        <a class="left-menu-link" href="landing-packing-list.html">
                            Packing List
                        </a>
                    </li>
					<li>
                        <a class="left-menu-link" href="landing-invoice.html">
                            Invoice
                        </a>
                    </li>
					<li>
                        <a class="left-menu-link" href="landing-credit-note.html">
                            Credit Note
                        </a>
                    </li>
                </ul>
            </li>
			<li class="left-menu-list-separator"><!-- --></li>
            <li>
                <a class="left-menu-link" href="barcode-printing.html">
                    <i class="left-menu-link-icon icmn-profile"><!-- --></i>
                    Barcode Printing
                </a>
            </li>
            <li class="left-menu-list-separator"><!-- --></li>
			<!-- remove "horizontal-left-direction" class, for get submenu with right direction (horizontal menu option) -->
            <li class="left-menu-list-submenu horizontal-left-direction">
                <a class="left-menu-link" href="javascript: void(0);">
                    Create
                </a>
                <!-- level 1 -->
                <ul class="left-menu-list list-unstyled">
                    <li class="left-menu-list-submenu">
                        <a class="left-menu-link" href="javascript: void(0);">
                            Master
                        </a>
                        <!-- level 2 -->
                        <ul class="left-menu-list list-unstyled">
						<li>
							<a class="left-menu-link" href="bank.html">
								Bank
							</a>
						</li>
						<li>
							<a class="left-menu-link" href="customer.html">
								Customer
							</a>
						</li>
						<li>
							<a class="left-menu-link" href="employee.html">
								Employee
							</a>
						</li>
						<li>
							<a class="left-menu-link" href="location.html">
								Location
							</a>
						</li>
						<li>
							<a class="left-menu-link" href="product.html">
								Product
							</a>
						</li>
						<li>
							<a class="left-menu-link" href="tax.html">
								Tax
							</a>
						</li>
						<li>
							<a class="left-menu-link" href="transporter.html">
								Transporter
							</a>
						</li>
                        </ul>
                    </li>
					<li class="left-menu-list-submenu">
                        <a class="left-menu-link" href="javascript: void(0);">
                            Sales
                        </a>
                        <!-- level 2 -->
                        <ul class="left-menu-list list-unstyled">
							<li>
								<a class="left-menu-link" href="sales-order.html">
									Sales Order
								</a>
							</li>
							<li>
								<a class="left-menu-link" href="packing-list.html">
									Packing List
								</a>
							</li>
							<li>
								<a class="left-menu-link" href="invoice.html">
									Invoice
								</a>
							</li>
							<li>
								<a class="left-menu-link" href="credit-note.html">
									Credit Note
								</a>
							</li>
                        </ul>
                    </li>
                </ul>
            </li>

			<li class="left-menu-list-separator"><!-- --></li>
            <li class="left-menu-list-submenu">
                <a class="left-menu-link" href="javascript: void(0);">
                    <i class="left-menu-link-icon icmn-files-empty2"><!-- --></i>
                    Masters
                </a>
                <ul class="left-menu-list list-unstyled">
                    <li>
                        <a class="left-menu-link" href="landing-bank.html">
                            Bank
                        </a>
                    </li>
                    <li>
                        <a class="left-menu-link" href="landing-customer.html">
                            Customer
                        </a>
                    </li>
					<li>
                        <a class="left-menu-link" href="landing-employee.html">
                            Employee
                        </a>
                    </li>
					<li>
                        <a class="left-menu-link" href="landing-location.html">
                            Location
                        </a>
                    </li>
					<li>
                        <a class="left-menu-link" href="landing-product.html">
                            Product
                        </a>
                    </li>
					<li>
                        <a class="left-menu-link" href="landing-tax.html">
                            Tax
                        </a>
                    </li>
					<li>
                        <a class="left-menu-link" href="landing-transporter.html">
                            Transporter
                        </a>
                    </li>
                </ul>
            </li>
		
			<li class="left-menu-list-separator"></li>
            <li>
                <a class="left-menu-link" href="#">
                    <i class="left-menu-link-icon icmn-profile"><!-- --></i>
                    Settings
                </a>
            </li>
            <li>
                <a class="left-menu-link" href="#">
                    <i class="left-menu-link-icon icmn-bubbles5"><!-- --></i>
                    Help
                </a>
            </li>
            <li>
                <a class="left-menu-link" href="#">
                    <i class="left-menu-link-icon icmn-mail2"><!-- --></i>
                    Support
                </a>
            </li>
            <li class="left-menu-list-separator"><!-- --></li>
            <li>
                <a class="left-menu-link" onclick = "sendSignoutRequest();" href="#">
                    <i class="left-menu-link-icon icmn-profile"><!-- --></i>
                    Sign Out
                </a>
            </li>
        </ul>
    </div>
</nav>
<nav class="top-menu" ng-class="{'hidden-top-menu': hideTopMenu}">
    <div class="menu-icon-container hidden-md-up">
        <div class="animate-menu-button left-menu-toggle">
            <div><!-- --></div>
        </div>
    </div>
    <div class="menu">
        <div class="menu-user-block">
            <div class="dropdown dropdown-avatar">
                <a href="javascript: void(0);" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                    <span class="avatar" href="javascript:void(0);">
                        <img src="../assets/common/img/temp/avatars/1.jpg" alt="Alternative text to the image">
                    </span>
                </a>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="" role="menu">
                    <a class="dropdown-item" href="javascript:void(0)"><i class="dropdown-icon icmn-user"></i> Profile</a>
                    <div class="dropdown-divider"></div>
                    <div class="dropdown-header">Home</div>
                    <a class="dropdown-item" href="javascript:void(0)"><i class="dropdown-icon icmn-circle-right"></i> System Dashboard</a>
                    <a class="dropdown-item" href="javascript:void(0)"><i class="dropdown-icon icmn-circle-right"></i> User Boards</a>
                    <a class="dropdown-item" href="javascript:void(0)"><i class="dropdown-icon icmn-circle-right"></i> Issue Navigator (35 New)</a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="javascript:void(0)"><i class="dropdown-icon icmn-exit"></i> Logout</a>
                </ul>
            </div>
        </div>
        <div class="menu-user-block menu-notifications">
            <div class="dropdown dropdown-avatar">
                <a href="javascript: void(0);" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                    <i class="menu-notification-icon icmn-bubbles7"></i>
                </a>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="" role="menu">
                    <div class="notification-block">
                        <div class="item">
                            <i class="notification-icon icmn-star-full"></i>
                            <div class="inner">
                                <div class="title">
                                    <span class="pull-right">now</span>
                                    <a href="javascript: void(0);">Update Status: <span class="label label-danger font-weight-700">New</span></a>
                                </div>
                                <div class="descr">
                                    Failed to get available update data. To ensure the proper functioning of your application, update now.
                                </div>
                            </div>
                        </div>
                        <div class="item">
                            <i class="notification-icon icmn-stack3"></i>
                            <div class="inner">
                                <div class="title">
                                    <span class="pull-right">24 min ago</span>
                                    <a href="javascript: void(0);">Income: <span class="label label-default font-weight-700">$299.00</span></a>
                                </div>
                                <div class="descr">
                                    Failed to get available update data. To ensure the proper functioning of your application, update now.
                                </div>
                            </div>
                        </div>
                        <div class="item">
                            <i class="notification-icon icmn-bubbles5"></i>
                            <div class="inner">
                                <div class="title">
                                    <span class="pull-right">30 min ago</span>
                                    <a href="javascript: void(0);">Inbox Message</a>
                                </div>
                                <div class="descr">
                                    From: <a href="javascript: void(0);">David Bowie</a>
                                </div>
                            </div>
                        </div>
                        <div class="item">
                            <i class="notification-icon icmn-pie-chart2"></i>
                            <div class="inner">
                                <div class="title">
                                    <span class="pull-right">now</span>
                                    <a href="javascript: void(0);">Update Status: <span class="label label-primary font-weight-700">New</span></a>
                                </div>
                                <div class="descr">
                                    Failed to get available update data. To ensure the proper functioning of your application, update now.
                                </div>
                            </div>
                        </div>
                        <div class="item">
                            <i class="notification-icon icmn-books"></i>
                            <div class="inner">
                                <div class="title">
                                    <span class="pull-right">24 min ago</span>
                                    <a href="javascript: void(0);">Income: <span class="label label-warning font-weight-700">$299.00</span></a>
                                </div>
                                <div class="descr">
                                    Failed to get available update data. To ensure the proper functioning of your application, update now.
                                </div>
                            </div>
                        </div>
                        <div class="item">
                            <i class="notification-icon icmn-cog util-spin-delayed-pseudo"></i>
                            <div class="inner">
                                <div class="title">
                                    <span class="pull-right">30 min ago</span>
                                    <a href="javascript: void(0);">Inbox Message</a>
                                </div>
                                <div class="descr">
                                    From: <a href="javascript: void(0);">David Bowie</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </ul>
            </div>
        </div>
        <div class="menu-info-block">
            <div class="left">
                <div class="header-buttons">
                    <div class="dropdown">
                        <a href="javascript: void(0);" class="dropdown-toggle dropdown-inline-button" data-toggle="dropdown" aria-expanded="false">
                            <i class="dropdown-inline-button-icon icmn-folder-open"></i>
                            <span class="hidden-lg-down">Issues History</span>
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="" role="menu">
                            <a class="dropdown-item" href="javascript:void(0)">Current search</a>
                            <a class="dropdown-item" href="javascript:void(0)">Search for issues</a>
                            <div class="dropdown-divider"></div>
                            <div class="dropdown-header">Opened</div>
                            <a class="dropdown-item" href="javascript:void(0)"><i class="dropdown-icon icmn-checkmark"></i> CLNUI-253 Project implemen...</a>
                            <a class="dropdown-item" href="javascript:void(0)"><i class="dropdown-icon icmn-checkmark"></i> CLNUI-234 Active history iss...</a>
                            <a class="dropdown-item" href="javascript:void(0)"><i class="dropdown-icon icmn-clock"></i> CLNUI-424 Ionicons intergrat...</a>
                            <a class="dropdown-item" href="javascript:void(0)">More...</a>
                            <div class="dropdown-divider"></div>
                            <div class="dropdown-header">Filters</div>
                            <a class="dropdown-item" href="javascript:void(0)">My open issues</a>
                            <a class="dropdown-item" href="javascript:void(0)">Reported by me</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item" href="javascript:void(0)">Import issues from CSV</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item" href="javascript:void(0)"><i class="dropdown-icon icmn-cog"></i> Settings</a>
                        </ul>
                    </div>
                    <div class="dropdown">
                        <a href="javascript: void(0);" class="dropdown-toggle dropdown-inline-button" data-toggle="dropdown" aria-expanded="false">
                            <i class="dropdown-inline-button-icon icmn-database"></i>
                            <span class="hidden-lg-down">Dashboards</span>
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="" role="menu">
                            <div class="dropdown-header">Active</div>
                            <a class="dropdown-item" href="javascript:void(0)">Project Management</a>
                            <a class="dropdown-item" href="javascript:void(0)">User Inetrface Development</a>
                            <a class="dropdown-item" href="javascript:void(0)">Documentation</a>
                            <div class="dropdown-header">Inactive</div>
                            <a class="dropdown-item" href="javascript:void(0)">Marketing</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item" href="javascript:void(0)"><i class="dropdown-icon icmn-cog"></i> Settings</a>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="left hidden-md-down">
                <div class="example-top-menu-chart">
                    <span class="title">Income:</span>
                    <span class="chart" id="topMenuChart" style="display: none;">1,5,1,7,5,6,6,1,4,7</span><svg class="peity" height="22" width="44"><rect fill="#01a8fe" x="0.44000000000000006" y="18.857142857142858" width="3.52" height="3.1428571428571423"></rect><rect fill="#01a8fe" x="4.840000000000001" y="6.285714285714285" width="3.5199999999999987" height="15.714285714285715"></rect><rect fill="#01a8fe" x="9.24" y="18.857142857142858" width="3.5199999999999996" height="3.1428571428571423"></rect><rect fill="#01a8fe" x="13.64" y="0" width="3.5199999999999996" height="22"></rect><rect fill="#01a8fe" x="18.04" y="6.285714285714285" width="3.520000000000003" height="15.714285714285715"></rect><rect fill="#01a8fe" x="22.439999999999998" y="3.1428571428571423" width="3.520000000000003" height="18.857142857142858"></rect><rect fill="#01a8fe" x="26.839999999999996" y="3.1428571428571423" width="3.5200000000000067" height="18.857142857142858"></rect><rect fill="#01a8fe" x="31.24" y="18.857142857142858" width="3.5200000000000067" height="3.1428571428571423"></rect><rect fill="#01a8fe" x="35.64" y="9.428571428571429" width="3.520000000000003" height="12.571428571428571"></rect><rect fill="#01a8fe" x="40.04" y="0" width="3.520000000000003" height="22"></rect></svg>
                    <span class="count">425.00 USD</span>

                    <!-- Top Menu Chart Script -->
                    <script>
                        $(function () {

                            var topMenuChart = $("#topMenuChart").peity("bar", {
                                fill: ['#01a8fe'],
                                height: 22,
                                width: 44
                            });

                            setInterval(function() {
                                var random = Math.round(Math.random() * 10);
                                var values = topMenuChart.text().split(",");
                                values.shift();
                                values.push(random);
                                topMenuChart.text(values.join(",")).change()
                            }, 1000);

                        });
                    </script>
                    <!-- Top Menu Chart Script -->
                </div>
            </div>
            <div class="right hidden-lg-down margin-left-20">
                <div class="search-block">
                    <div class="form-input-icon form-input-icon-right">
                        <i class="icmn-search"></i>
                        <input class="form-control form-control-sm form-control-rounded" placeholder="Search..." type="text">
                        <button type="submit" class="search-block-submit "></button>
                    </div>
                </div>
            </div>

        </div>
    </div>
</nav>
<section class = "page-content">
<div class="page-content-inner">

    <!-- Ecommerce Product Details -->
    <section class="panel panel-with-borders" style="overflow:auto">
        <div class="panel-heading">
            <h2>
				<!--<div class="dropdown pull-right">
					<button id = "buttonAddProduct" type="button" class="btn btn-primary" style = "display:none" onclick = "addColorToTable();" >
                        Add Product
                    </button>
					</div>-->
                <span id = "title">Create New Credit Note</span>
            </h2>
        </div>
        <div class="panel-body">
			<div class="nav-tabs-horizontal" id = "homeTabs">
				<ul class="nav nav-tabs" role="tablist">
					<li class="nav-item" id = "tab-billing-details">
						<a id = "0" class="nav-link active" href="javascript: void(0);" data-toggle="tab" data-target="#tab1" role="tab" aria-expanded="false">Billing Details</a>
					</li>
					<li class="nav-item" id = "tab-add-product">
						<a id = "1" class="nav-link" href="javascript: void(0);" data-toggle="tab" data-target="#tab2" role="tab" aria-expanded="true">Add Product</a>
					</li>
					<li class="nav-item" id = "tab-others">
						<a id = "2" class="nav-link" href="javascript: void(0);" data-toggle="tab" data-target="#tab3" role="tab" aria-expanded="true">Others</a>
					</li>
				</ul>
				<script>
				$(document).ready(function(){
						
						$('#tab-billing-details').click(function(){
							$('#buttonAddProduct').hide();
						});

						$('#tab-add-product').click(function(){
							$('#buttonAddProduct').show();
						});

						$('#tab-others').click(function(){
							$('#buttonAddProduct').hide();
						});

				});
				</script>
				<div id = "form-validation" class="tab-content padding-vertical-20">
					<div class="tab-pane active" id="tab1" role="tabpanel" aria-expanded="false">
						
						<div class = "col-lg-5">
							<div class="form-group">
                                <label for="selectInvoice">Select Invoice For Returns*</label>
								<select class="form-control" id="selectInvoice" name="validation[invoice]"
																					   data-validation="[L>=1]"
																					   data-validation-message="Please choose a valid $">
								</select>
                            </div>
							<div class="form-group">
                                <label for="purchaseOrderReference">Purchase Order Reference</label>
                                <input class="form-control" id="purchaseOrderReference" type="text" readonly>
                            </div>

							<div class="form-group">
								<label class="form-control-label" for="billingAddress">Billing Address</label>
								<textarea class="form-control" rows="3" id="billingAddress" readonly></textarea>
							</div>
						
							<div class="form-group">
                                <label for="city">City</label>
								<input class="form-control" id="city" type="text" readonly>
                            </div>
							
							<div class="form-group">
                                <label for="district">District</label>
                                <input class="form-control" id="district" type="text" readonly>
                            </div>
						
							<div class="form-group">
                                <label for="contactPerson">Contact Person*</label>
                                <input class="form-control" id="contactPerson" type="text" readonly>
                            </div>
							
							<div class="form-group">
                                <label for="emailAddress">Email Address</label>
                                <input class="form-control" id="emailAddress" type="text" readonly>
                            </div>
						</div>
						
						
						<div class = "col-lg-5" style="padding-left:100px;">
							<div class = "row">	
								<div class = "col-lg-6">	
									<div class="form-group">
										<label for="invoiceRevisionNumber">Invoice Revision Number</label>
										<input class="form-control" id="invoiceRevisionNumber" type="number" readonly>
									</div>
								</div>
								<div class = "col-lg-6">	
									<div class="form-group">
										<label for="invoiceDate">Invoice Date</label>
										<input class="form-control" id="invoiceDate" type="text" readonly>
									</div>
								</div>
							</div>
							
							<div class="form-group">
                                <label for="clientName">Client Name</label>
								<input class="form-control" id="clientName" type="text" readonly>
                            </div>
							
							<div class="form-group">
								<label class="form-control-label" for="deliveryAddress">Delivery Address</label>
								<textarea class="form-control" rows="3" id="deliveryAddress" readonly></textarea>
							</div>
							
							<div class="form-group">
                                <label for="pinCode">Pin Code</label>
                                <input class="form-control" id="pinCode" type="text" readonly>
                            </div>
							
							<div class="form-group">
                                <label for="state">State</label>
								<input class="form-control" id="state" type="text" readonly>
                            </div>
							
							<div class="form-group">
                                <label for="contactNumber">Contact Number</label>
                                <input class="form-control" id="contactNumber" type="text" readonly>
                            </div>							
						</div>
					</div>
					<div class="tab-pane" id="tab2" role="tabpanel" aria-expanded="true">
						<div class = "col-lg-12">
						<div id = "productErrorDiv" style = "display:none"><span style="color:#FF0000; margin:20px;">Please add atleast 1 product</span></br></br></div>
							<table class="table table-hover nowrap" id="productsTable" width="100%">
								<thead class="thead-default">
									<tr>
										<th rowspan = "2">Product No.</th>
										<th rowspan = "2">Style Code</th>
										<th rowspan = "2">Color Code</th>					
										<th rowspan = "2">Gender</th>
										<th colspan = "11">
											&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
											&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
											&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
											&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
											&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
											&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
											&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
										Size
										</th>
									</tr>
									<tr>
										<th>28</th>
										<th>30</th>
										<th>32</th>
										<th>34</th>
										<th>36</th>
										<th>38</th>
										<th>40</th>
										<th>42</th>
										<th>44</th>
										<th>46</th>
										<th>48</th>
									</tr>
								</thead>
								<tfoot>
																<tr>
										<th rowspan = "2">Product No.</th>
										<th rowspan = "2">Style Code</th>
										<th rowspan = "2">Color Code</th>					
										<th rowspan = "2">Gender</th>
										<th colspan = "11">
											&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
											&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
											&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
											&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
											&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
											&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
											&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
										Size
										</th>
									</tr>
									<tr>
										<th>28</th>
										<th>30</th>
										<th>32</th>
										<th>34</th>
										<th>36</th>
										<th>38</th>
										<th>40</th>
										<th>42</th>
										<th>44</th>
										<th>46</th>
										<th>48</th>
									</tr>
								</tfoot>
									<tbody id = 'productsTableBody'>
								</tbody>
							</table>
						</div>
					</div>
					<script>
						$(function () {
							dataTable = $('#productsTable').DataTable();
						});
					</script>
					<div class="tab-pane" id="tab3" role="tabpanel" aria-expanded="true">
						<div class = "col-lg-5">
							<div class="form-group">
                                <label for="transportName">Transport Name</label>
                                <input class="form-control" id="transportName" readonly>
                            </div>
							<div class="form-group">
                                <label for="numberOfPackages">Number Of Packages</label>
                                <input class="form-control" id="numberOfPackages" type="number">
                            </div>
							<div class="form-group">
                                <label for="lorryReceiptNumber">Lorry Receipt Number</label>
                                <input class="form-control" id="lorryReceiptNumber"  name="validation[Lorry Receipt Number]"
																					   data-validation="[L>=1]"
																					   data-validation-message="Please enter a valid $">
                            </div>
						</div>
						<div class = "col-lg-5" style="padding-left:100px;">
							
							<div class="form-group">
                                <label for="returnDate">Return Date*</label>
                                <input class="form-control" id="returnDate" type="date"  name="validation[return date]"
																					   data-validation="[L>=1]"
																					   data-validation-message="Please choose a valid $">
                            </div>
							
							<div class="form-group">
                                <label for="grossWeight">Gross Weight (kgs)*</label>
                                <input class="form-control" id="grossWeight" type="number">
                            </div>
							
							<div class="form-group">
                                <label for="returnReason">Return Reason</label>
                                <input class="form-control" id="returnReason">
                            </div>
						</div>
						<div class = "col-lg-10">
							<div class="form-group">
								<label class="form-control-label" for="returnNote">Return Notes</label>
								<textarea class="form-control" rows="7" id="returnNote"></textarea>
							</div>							
						</div>
					</div>

					<div class="form-group" >
						<div class="col-md-9" style="padding-bottom:20px;">
							<button type="submit" class="btn width-150 btn-primary" id = "btnSave" style="margin:10px" onclick="createOrUpdateCreditNote()">Save</button>
							<button type="button" class="btn width-150 btn-default" id = "btnBack" style="margin:10px">Back</button>
							<button type="button" class="btn width-150 btn-default" id = "btnNext" style="margin:10px">Next</button>
							<button type="button" class="btn width-150 btn-default" style="margin:10px" onclick = "goBackToLandingPage();">Cancel</button>
							<button type="button" class="btn width-150 btn-default" id = "btnPreview" style="margin:10px; background-color:#5dc698; border-color:#5dc698; display:none" onclick = "showPreview();">Preview</button>
						</div>
                    </div>
				</div>
			</div>

		</div>
	</section>
</div>	
</section>

<script>
	var creditNoteId = -1;
	function goBackToLandingPage(){
		window.location = "landing-credit-note.html";
	}
	
	function showPreview(){				
		window.location = "preview-credit-note.html?creditNoteId="+ getParameterByName('creditNoteId');
	}
	
	$(window).load(function() {
		if(getParameterByName('creditNoteId')==null){
			getInvoiceIds();
			//document.getElementById('returnDate').value = print_today();
		} else {
			document.getElementById('title').innerHTML = "Edit Credit Note";
			creditNoteId = getParameterByName('creditNoteId');
			$.ajaxSetup({
				  headers : {
					'Authorization' : 'Bearer ' + localStorage.getItem("token")
				  }
			});
			$.getJSON(base_url + "/AdValoramAdmin/creditNote/"+creditNoteId, function(data){
				var creditNote = data.result[0];
				var invoice = creditNote.linkedInvoice;
				var salesOrder = creditNote.linkedInvoice.linkedSalesOrder;
				
				if(creditNote.status == "OPEN" || creditNote.status == "ISSUED"){
					$('#btnPreview').show();
				} else {
					$('#btnPreview').hide();
				}
				var selectInvoice = document.getElementById('selectInvoice');
				removeOptions(selectInvoice);
				var opt = document.createElement('option');
				opt.value = invoice.invoiceId;	//internal DB ID 
				opt.innerHTML = invoice.invoiceId;
				selectInvoice.appendChild(opt);
				selectInvoice.disabled = true;
				
				document.getElementById('invoiceRevisionNumber').value = invoice.invoiceRevisionNumber;
				document.getElementById('invoiceDate').value = (invoice.invoiceDate).split(" ")[0];
				
				document.getElementById('numberOfPackages').value = creditNote.numberOfPackages;
				document.getElementById('lorryReceiptNumber').value = creditNote.lorryReceiptNumber;
				document.getElementById('returnDate').value = (creditNote.returnDate).split(" ")[0];
				document.getElementById('grossWeight').value = creditNote.grossWeight;
				document.getElementById('returnNote').value = creditNote.returnNote;
				document.getElementById('returnReason').value = creditNote.returnReason;
				
				
				document.getElementById("purchaseOrderReference").value = salesOrder.purchaseOrderReference;
				
				document.getElementById('billingAddress').value = salesOrder.clientBillingAddressOnSalesOrderDate;
				document.getElementById('deliveryAddress').value = salesOrder.clientDeliveryAddressOnSalesOrderDate;
				document.getElementById('city').value = salesOrder.clientCityOnSalesOrderDate;
				document.getElementById('district').value = salesOrder.clientDistrictOnSalesOrderDate;
				document.getElementById('state').value = salesOrder.clientStateOnSalesOrderDate;
				document.getElementById('pinCode').value = salesOrder.clientPinCodeOnSalesOrderDate;
				document.getElementById('contactPerson').value = salesOrder.clientContactPersonOnSalesOrderDate;
				document.getElementById('contactNumber').value = salesOrder.clientContactPersonOnSalesOrderDate;
				document.getElementById('emailAddress').value = salesOrder.clientEmailAddressOnSalesOrderDate;
				document.getElementById('clientName').value = salesOrder.clientNameOnSalesOrderDate;	
				
				if(salesOrder.linkedCustomer.linkedTransporter.companyName!=null){
					document.getElementById('transportName').value = salesOrder.linkedCustomer.linkedTransporter.companyName;		
				}
				
				var packingListEntryJson =	invoice.linkedPackingList.entry;
				var packingListEntries = [];
				var linkedPackingList = new Object();
				linkedPackingList.packingListEntries = packingListEntries;
				
				//packing list entries start
				for(var s = 0; s < packingListEntryJson.length; s++){
					var entryJson = packingListEntryJson[s];
					var size = parseInt(entryJson.stockKeepingUnit.sizeCode.sizeCode);

					var entryId = entryJson.entryId;
					var packingListEntry = packingListEntries[entryId];
					if(packingListEntry == null){
						packingListEntry = new Object();
						packingListEntry.id = entryJson.entryId;
						packingListEntry.styleCode = entryJson.stockKeepingUnit.styleCode;
						packingListEntry.productCategory = entryJson.stockKeepingUnit.productCategory.id;
						packingListEntry.mrp = entryJson.stockKeepingUnit.mrp;
						packingListEntry.gender = entryJson.stockKeepingUnit.genderCode.gender;
						packingListEntry.genderCode = entryJson.stockKeepingUnit.genderCode.genderCode;
						packingListEntry.colorCode = entryJson.stockKeepingUnit.colorCode.colorCode;
						packingListEntries[packingListEntry.id] = packingListEntry;
					} else {
						//compare
						if(packingListEntry.styleCode != entryJson.stockKeepingUnit.styleCode){
							console.log("ERROR. Color code does not match " + entryJson.entryId);
							return;
						}
						if(packingListEntry.gender != entryJson.stockKeepingUnit.genderCode.gender){
							console.log("ERROR. genderCode does not match " + entryJson.entryId);
							return;
						}
						if(packingListEntry.colorCode != entryJson.stockKeepingUnit.colorCode.colorCode){
							console.log("ERROR. colorCode does not match " + entryJson.entryId);
							return;
						}
						if(packingListEntry.mrp != entryJson.stockKeepingUnit.mrp){
							console.log("ERROR. mrp does not match " + entryJson.entryId);
							return;
						}
					}
					
					var key = "quantityForSize" + size;
					packingListEntry[key] = entryJson.quantity;	

					}

					var pl = linkedPackingList;
					var ple = pl.packingListEntries;
					var packingListEntryKeys = Object.keys(ple).sort();
					for(var e = 0; e < packingListEntryKeys.length; e++){
						var index = packingListEntryKeys[e];

						var packingListEntry = ple[index];
						packingList.push(packingListEntry);
					}	

					//credit note entry
					
					var creditNoteEntryJson =	creditNote.entry;
					var creditNoteEntries = [];
					var linkedCreditNote = new Object();
					linkedCreditNote.creditNoteEntries = creditNoteEntries;
					for(var s = 0; s < creditNoteEntryJson.length; s++){
						var entryJson = creditNoteEntryJson[s];
						var size = parseInt(entryJson.stockKeepingUnit.sizeCode.sizeCode);

						var entryId = entryJson.entryId;
						var creditNoteEntry = creditNoteEntries[entryId];
						if(creditNoteEntry == null){
							creditNoteEntry = new Object();
							creditNoteEntry.id = entryJson.entryId;
							creditNoteEntry.styleCode = entryJson.stockKeepingUnit.styleCode;
							creditNoteEntry.productCategory = entryJson.stockKeepingUnit.productCategory.id;
							creditNoteEntry.mrp = entryJson.stockKeepingUnit.mrp;
							creditNoteEntry.gender = entryJson.stockKeepingUnit.genderCode.gender;
							creditNoteEntry.genderCode = entryJson.stockKeepingUnit.genderCode.genderCode;
							creditNoteEntry.colorCode = entryJson.stockKeepingUnit.colorCode.colorCode;
							creditNoteEntries[creditNoteEntry.id] = creditNoteEntry;
						} else {
							//compare
							if(creditNoteEntry.styleCode != entryJson.stockKeepingUnit.styleCode){
								console.log("ERROR. Color code does not match " + entryJson.entryId);
								return;
							}
							if(creditNoteEntry.gender != entryJson.stockKeepingUnit.genderCode.gender){
								console.log("ERROR. genderCode does not match " + entryJson.entryId);
								return;
							}
							if(creditNoteEntry.colorCode != entryJson.stockKeepingUnit.colorCode.colorCode){
								console.log("ERROR. colorCode does not match " + entryJson.entryId);
								return;
							}
							if(creditNoteEntry.mrp != entryJson.stockKeepingUnit.mrp){
								console.log("ERROR. mrp does not match " + entryJson.entryId);
								return;
							}
						}
						
						var key = "quantityForSize" + size;
						creditNoteEntry[key] = entryJson.quantity;	

						}

						var pl = linkedCreditNote;
						var ple = pl.creditNoteEntries;
						var creditNoteEntryKeys = Object.keys(ple).sort();
						for(var e = 0; e < creditNoteEntryKeys.length; e++){
							var index = creditNoteEntryKeys[e];

							var creditNoteEntry = ple[index];
							productList.push(creditNoteEntry);
						}					
				
					refreshProductsTable();
				
			});
		}
	});
	
	function limitQuantityTo(element, productListIndex, key, maxQuantity){
		if(element.value > maxQuantity){
			element.value = maxQuantity;
		}
		var key = "quantityForSize"+key;
		productList[productListIndex][key] = parseInt(element.value);
	}
	
	var productList = [];
	var packingList = [];
	function refreshProductsTable(){
		$('#productsTable').dataTable().fnDestroy();
		var tbody = '';
		for(var p = 0; p < productList.length; p++){
			var product = productList[p];
			var packingListItem = packingList[p];
				tbody +=  "<tr>" +
				"<td>" + product.id + "</td>"+
				"<td>" + product.styleCode + "</td>"+
				"<td>" + product.colorCode + "</td>"+
				"<td>" + product.gender + "</td>";
				
				for(var s = 28; s <=48; s = s+2){
					var prefix = "quantityForSize";
					var key = prefix + s;
	
					if(product[key]!=null)	{
						if(getParameterByName('creditNoteId')!=null){
							tbody+="<td><input class = 'form-control' type='number' min='0' value='" + product[key] + "' onchange = limitQuantityTo(this," + p + ","+s+"," + packingListItem[key]+"); max='" + packingListItem[key] + "'></td>";
						} else {
							tbody+="<td><input class = 'form-control' type='number' min='0' value='" + product[key] + "' onchange = limitQuantityTo(this," + p + ","+s+"," + product[key]+"); max='" + product[key] + "'></td>";
						}
					} else {
						tbody+="<td>0</td>";
					}
				
				}			
		}
		$('#productsTableBody').html(tbody);	
		dataTable = $('#productsTable').DataTable();	
	}
	
	function createOrUpdateCreditNote(){
		
		var creditNote = new Object();
		var selectInvoice = document.getElementById('selectInvoice');
				
		if(selectInvoice.value.length <= 0){	//VALIDATE - INVOICE
			$('.nav-tabs-horizontal li:eq(0) a').tab('show')
			return;
		}
		if(document.getElementById('lorryReceiptNumber').value == ""
		|| document.getElementById('returnDate').value == ""){
			$('.nav-tabs-horizontal li:eq(2) a').tab('show')
			return;
		}
		NProgress.start();		
		var linkedInvoiceId = selectInvoice.options[selectInvoice.selectedIndex].value;
		creditNote.linkedInvoiceId = linkedInvoiceId;

		
		creditNote.numberOfPackages = document.getElementById('numberOfPackages').value;
		creditNote.grossWeight = document.getElementById('grossWeight').value;
		creditNote.lorryReceiptNumber = document.getElementById('lorryReceiptNumber').value;
		creditNote.returnReason = document.getElementById('returnReason').value;
		creditNote.returnNote = document.getElementById('returnNote').value;
		creditNote.returnDate = document.getElementById('returnDate').value;
		
		if(productList.length < 1){					//VALIDATE - PRODUCT
			$('.nav-tabs-horizontal li:eq(1) a').tab('show');
			tabFunction(1);
			document.getElementById('productErrorDiv').style.display = "block";
			return;
		} else {
			document.getElementById('productErrorDiv').style.display = "none";
		}
		
		creditNote.productList = productList;
		
		document.getElementById('btnSave').disabled = true;
		
		var request = new XMLHttpRequest();
		request.onreadystatechange = function(){
			console.log(request.readyState+" " + request.status);
			NProgress.inc();			
			if(request.readyState == 4 && request.status == 200){
				var response = JSON.parse(request.response);
				if(response.result == "success"){	
					NProgress.done();
					window.location = "credit-note.html?creditNoteId="+response.creditNoteId;			
				}
			}
		};
		
		if(creditNoteId < 0){
			request.open ("POST", base_url + "/AdValoramAdmin/creditNote", true);
		} else {
			request.open ("PUT", base_url + "/AdValoramAdmin/creditNote/" + creditNoteId, true);
		}
		request.setRequestHeader("Authorization", "Bearer " + localStorage.getItem("token"));
		request.setRequestHeader("content-type", "application/json");
		request.send(JSON.stringify(creditNote));
	}
	
	function getInvoiceIds(){
		$.ajaxSetup({
			  headers : {
				'Authorization' : 'Bearer ' + localStorage.getItem("token")
			  }
		}); 
		$.getJSON(base_url + "/AdValoramAdmin/invoice/idlist", function(data){
		
			var selectInvoice = document.getElementById('selectInvoice');
			removeOptions(selectInvoice);
			for(var i = 0; i < data.result.length; i++){
				var id = data.result[i];
				var opt = document.createElement('option');
				opt.value = id;	//internal DB ID 
				opt.innerHTML = id;
				selectInvoice.appendChild(opt);
			}
			selectInvoice.selectedIndex = -1;
			
			//add event listener only if user is creating an unlinked invoice
			selectInvoice.addEventListener("change", function() {
			var invoiceInternalId = selectInvoice.value;

			$.getJSON(base_url + "/AdValoramAdmin/invoice/"+invoiceInternalId, function(data){
				NProgress.start();
				var salesOrder;
				var linkedPackingLists;
				var linkedCustomer;

				salesOrder = data.result[0].linkedSalesOrder;
				linkedPackingList = data.result[0].linkedPackingList;

				//document.getElementById('numberOfPackages').value = data.result[0].numberOfPackages;
				document.getElementById('invoiceRevisionNumber').value = data.result[0].invoiceRevisionNumber;
				//document.getElementById('grossWeight').value = data.result[0].grossWeight;
				//document.getElementById('lorryReceiptNumber').value = data.result[0].lorryReceiptNumber;				
				document.getElementById('invoiceDate').value = (data.result[0].invoiceDate).split(" ")[0];
				//document.getElementById('numberOfPackages').disabled = true;
				document.getElementById('invoiceRevisionNumber').disabled = true;
				//document.getElementById('grossWeight').disabled = true;
				//document.getElementById('lorryReceiptNumber').disabled = true;
				
				linkedCustomer = salesOrder.linkedCustomer;				

				document.getElementById('clientName').value = linkedCustomer.companyName;		
				 
				linkedSalesOrderInternalId = salesOrder.id;			
				document.getElementById("purchaseOrderReference").value = salesOrder.purchaseOrderReference;
				
				document.getElementById('billingAddress').value = salesOrder.clientBillingAddressOnSalesOrderDate;
				document.getElementById('deliveryAddress').value = salesOrder.clientDeliveryAddressOnSalesOrderDate;
				document.getElementById('city').value = salesOrder.clientCityOnSalesOrderDate;
				document.getElementById('district').value = salesOrder.clientDistrictOnSalesOrderDate;
				document.getElementById('state').value = salesOrder.clientStateOnSalesOrderDate;
				document.getElementById('pinCode').value = salesOrder.clientPinCodeOnSalesOrderDate;
				document.getElementById('contactPerson').value = salesOrder.clientContactPersonOnSalesOrderDate;
				document.getElementById('contactNumber').value = salesOrder.clientContactPersonOnSalesOrderDate;
				document.getElementById('emailAddress').value = salesOrder.clientEmailAddressOnSalesOrderDate;
				document.getElementById('returnDate').min = data.result[0].invoiceDate.split(" ")[0];
				
				if(salesOrder.linkedCustomer.linkedTransporter.companyName!=null){
					document.getElementById('transportName').value = salesOrder.linkedCustomer.linkedTransporter.companyName;		
				}
				
				<!---------- ------------------!>
				
				var packingListEntryJson =	data.result[0].linkedPackingList.entry;
				var packingListEntries = [];
				linkedPackingList.packingListEntries = packingListEntries;
				
				//packing list entries start
				for(var s = 0; s < packingListEntryJson.length; s++){
					var entryJson = packingListEntryJson[s];
					var size = parseInt(entryJson.stockKeepingUnit.sizeCode.sizeCode);

					var entryId = entryJson.entryId;
					var packingListEntry = packingListEntries[entryId];
					if(packingListEntry == null){
						packingListEntry = new Object();
						packingListEntry.id = entryJson.entryId;
						packingListEntry.styleCode = entryJson.stockKeepingUnit.styleCode;
						packingListEntry.productCategory = entryJson.stockKeepingUnit.productCategory.id;
						packingListEntry.mrp = entryJson.stockKeepingUnit.mrp;
						packingListEntry.gender = entryJson.stockKeepingUnit.genderCode.gender;
						packingListEntry.genderCode = entryJson.stockKeepingUnit.genderCode.genderCode;
						packingListEntry.colorCode = entryJson.stockKeepingUnit.colorCode.colorCode;
						packingListEntries[packingListEntry.id] = packingListEntry;
					} else {
						//compare
						if(packingListEntry.styleCode != entryJson.stockKeepingUnit.styleCode){
							console.log("ERROR. Color code does not match " + entryJson.entryId);
							return;
						}
						if(packingListEntry.gender != entryJson.stockKeepingUnit.genderCode.gender){
							console.log("ERROR. genderCode does not match " + entryJson.entryId);
							return;
						}
						if(packingListEntry.colorCode != entryJson.stockKeepingUnit.colorCode.colorCode){
							console.log("ERROR. colorCode does not match " + entryJson.entryId);
							return;
						}
						if(packingListEntry.mrp != entryJson.stockKeepingUnit.mrp){
							console.log("ERROR. mrp does not match " + entryJson.entryId);
							return;
						}
					}
					NProgress.inc();
					var key = "quantityForSize" + size;
					packingListEntry[key] = entryJson.quantity;	

					}

					var pl = linkedPackingList;
					var ple = pl.packingListEntries;
					var packingListEntryKeys = Object.keys(ple).sort();
					for(var e = 0; e < packingListEntryKeys.length; e++){
						var index = packingListEntryKeys[e];

						var packingListEntry = ple[index];
						productList.push(packingListEntry);
					}					
				
					refreshProductsTable();
					NProgress.done();
					});
					
				});
			
		});
	}
</script>
</body>
</html>